python-ptrace
=============

python library for ptrace


###Demo
```c
#include <stdio.h>
#include <time.h>
#include <unistd.h>

char *msg[] = {"Hello world"};

int main(int argc, char **argv)
{
	printf("pid: %d\n", getpid());
	printf("msg: 0x%x\n", *msg);
	while (1) {
		sleep(1);
	}
	return 0;
}
```
###Usage
####read_memory(pid, addr, len) 
```shell
$: ./main
pid: 3185
msg: 0x4006e4 

In [1]: import ptrace

In [2]: ptrace.attach(3185)

In [4]: ptrace.read_memory(3185, 0x4006e4, 12)
Out[4]: 'Hello world\x00'

In [5]: ptrace.detach(3185)
```
####write_memory(pid, addr, len) 
```shell
$: ./main
pid: 3185
msg: 0x4006e4 

In [1]: import ptrace

In [2]: ptrace.attach(3185)

In [3]: ptrace.write_memory(3185, 0x4006e4, "123456")

In [4]: ptrace.read_memory(3185, 0x4006e4, 12)
Out[4]: '123456world\x00'

In [5]: ptrace.detach(3185)
```

####getregs(pid)
```shell
In [11]: ptrace.getregs(3185)
Out[11]: 
{'cs': 51L,
 'ds': 0L,
 'eflags': 582L,
 'es': 0L,
 'fs': 0L,
 'fs_base': 139769800140544L,
 'gs': 0L,
 'gs_base': 0L,
 'orig_rax': 35L,
 'r10': 8L,
 'r11': 582L,
 'r12': 4195584L,
 'r13': 140736885054864L,
 'r14': 0L,
 'r15': 0L,
 'r8': 140736885054432L,
 'r9': 139769798071872L,
 'rax': 18446744073709551100L,
 'rbp': 4294967295L,
 'rbx': 140736885054176L,
 'rcx': 18446744073709551615L,
 'rdi': 140736885054160L,
 'rdx': 0L,
 'rip': 139769795002800L,
 'rsi': 140736885054160L,
 'rsp': 140736885054152L,
 'ss': 43L}
```
####getfpregs(pid)
```shell
In [13]: ptrace.getfpregs(3185)
Out[13]: 
{'cwd': 0L,
 'fop': 0L,
 'ftw': 0L,
 'mxcr_mask': 0L,
 'mxcsr': 4195584L,
 'rdp': 140736885054864L,
 'rip': 0L, 
 'st': '\xff\xff\xff\xff\x00\x00\x00\x00\xe0Z\n\xdc\xff\x7f\x00\x00F\x02\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00@\x16*\xb1\x1e\x7f\x00\x00\xe0[\n\xdc\xff\x7f\x00\x00\xfc\xfd\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xd0Z\n\xdc\xff\x7f\x00\x00\xd0Z\n\xdc\xff\x7f\x00\x00#\x00\x00\x00\x00\x00\x00\x00\xb0A\xfb\xb0\x1e\x7f\x00\x003\x00\x00\x00\x00\x00\x00\x00F\x02\x00\x00\x00\x00\x00\x00\xc8Z\n\xdc\xff\x7f\x00\x00',
 'swd': 0L,
 'xmm': '\xff\xff\xff\xff\x00\x00\x00\x00\xe0Z\n\xdc\xff\x7f\x00\x00F\x02\x00\x00\x00\x00\x00\x00\x08\x00\x00\x00\x00\x00\x00\x00@\x16*\xb1\x1e\x7f\x00\x00\xe0[\n\xdc\xff\x7f\x00\x00\xfc\xfd\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x00\x00\xd0Z\n\xdc\xff\x7f\x00\x00\xd0Z\n\xdc\xff\x7f\x00\x00#\x00\x00\x00\x00\x00\x00\x00\xb0A\xfb\xb0\x1e\x7f\x00\x003\x00\x00\x00\x00\x00\x00\x00F\x02\x00\x00\x00\x00\x00\x00\xc8Z\n\xdc\xff\x7f\x00\x00+\x00\x00\x00\x00\x00\x00\x00\x00\xa7I\xb1\x1e\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x10\x13\x0e\x86\xa5\x7f\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00P\xd9\x94\x02\x00\x00\x00\x00\x10b\xbb\x02\x00\x00\x00\x00p\xe48\x02\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00'}
 ```
